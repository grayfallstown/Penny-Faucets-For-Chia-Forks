<!html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            max-width: 800px;
            background: linear-gradient(90deg, rgba(0,0,0,1) 0%, rgba(17,17,17,1) 100%);
            color: #ccc;
            max-width: 1200px;
            font-family: sans-serif;
        }
    </style>
</head>
<body>
    <script>
        function addChart(currencyID, data) {
            var h2 = document.createElement('h2');
            h2.innerText = currencyID;
            document.body.appendChild(h2);

            var canvas = document.createElement('canvas');
            canvas .id = currencyID;
            canvas.classList = ['canvas'];
            document.body.appendChild(canvas);

            const labels = Object.keys(data).map((d) => new Date(d).toLocaleDateString("en-US"));
            const chartData = {
                labels: labels,
                datasets: [{
                    label: currencyID,
                    backgroundColor: 'rgb(255, 99, 132)',
                    borderColor: 'rgb(255, 99, 132)',
                    fillColor: "rgba(220,220,220,0.0)",
                    strokeColor: "rgba(220,220,220,0)",
                    pointColor: "rgba(220,220,220,0)",
                    pointStrokeColor: "#fff",
                    pointHighlightFill: "#fff",
                    pointHighlightStroke: "rgba(220,220,220,1)",
                    data: Object.keys(data).map((key) => data[key]),
                }]
            };
            const config = {
                type: 'line',
                data: chartData,
                options: {
				}
            };

			var myChart = new Chart(
				document.getElementById(currencyID),
				config
			);
        }

        function addCharts(json) {
            var keys = Object.keys(json);
            keys.sort();
            keys.forEach((currencyId) => addChart(currencyId, json[currencyId]));
        }

        fetch("./targets-by-currency-by-date.json")
            .then(response => response.json())
            .then(addCharts);
    </script>
</body>
